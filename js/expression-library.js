const mgGroupSpec = (n,r) => arrayOfIndexes(n-1)
        .filter( i => (i == 0) || !Number.isInteger( n / (i+1)) )
        .filter( i => (i == 0) || gcd( n, (i+1) ) == 1 )
        .map( i => `${i+1}@${n}` + (r ? ` * ${ r }` : ''));

const mgGroups = ( vols ) => {
    const result = {};
    vols.forEach( v => {
        result[ `${  v } (mg ${ v - 1 })` ] = mgGroupSpec( v - 1 );
    } );
    return result;
};

const expressionLibrary = {
    'blank': [],

    'default': [
//        '4@7',
//        '4@7~5',
//        '4@19',
//        '2~(4@19)',
//        '',
//        'e = (5:4:2 [2,1,0])',
//        '5:4:2 [2,0,1][1,2,0]',
//        '(4@7~5)*(2~(4@19))',
        '2:3:5',
//        '4@39',
//        '10:4',
//        '4:10'
    ],

    'literals': [
        'a = (2:3); b = (5:7);',
        'c = (a~b)',
        'c/b',
        'd = (b~a)',
        'd/a',
//        'e',
//        'e',
//
//        'k = ([(1,31) 0..31] / mb); e; e; e;',
//        'e; e; e; e;',
//
//        'k; e; e; e;',
//        'e; e; e; e;',
//        'e; e; e; e;',
//
//        'k; e; e; e;',
//        'e; e; e; e;',
    ],

    'decomposition': [
        '&vars a = 5, b = 4, c = 2',
        '4:5.2',
        '(b:c~a) * (c~b:a) # == b:a.c',
        '5.2:4',
        '(c~a:b) * (c:b~a) # == a.c:b',
        '2:5.4',
        '(c:a~b) * (a~c:b) # == c:a.b',
        '5.4:2',
        '(a~b:c) * (a:c~b) # == a.b:c',
        '4.2:5',
        '(c~b:a) * (c:a~b) # == b.c:a',
        '5:4.2',
        '(a:c~b) * (c~a:b) # == a:b.c',
    ],

    'a:b:c': [
        '&vars a = 5, b = 4, c = 2',
        'a0 = (b:c~a)',
        //'a0h = (a~b:c)',
        //'a0i = (c:b~a)',
        'a0hi = (a~c:b)',

        'b0 = (c:a~b)',
        'b0hi = (b~a:c)',

        'c0 = (a:b~c)',
        'c0hi = (c~b:a)',

        'a1 = (a0 * c0hi)',
        'b1 = (c0 * b0hi)',
        'c1 = (b0 * a0hi)',

        'z1 = (b1 * a0)',
        'z2 = (c1 * c0)',
        'z3 = (a1 * b0)',
    ],

    'products': [
        '(2:4)',
        '(2:4)~5',
        '(4:2)~5',
        '5~(4:2)',
        '5~(2:4)',
        '5:2:2:2',
        '(5:2)~(2:2)',
        '5~(2:2)~2',
    ],

    'powers': [
        '(10:4)^-1',
        '(10:4)^0',
        '(10:4)^1',
        '(10:4)^2',
        '(10:4)^3',
        '(10:4)^4',
        '(10:4)^5',
        '(10:4)^6',
    ],

    '5x3x2': [
//        '5:3~2; 2:5~3; 3:2~5',
//        '2~5:3; 3~2:5; 5~3:2',
        '5:8; 3:10; 2:20',
        '5:3:2; 2:5:3; 3:2:5',
        '(3~5:2) * (3:2~5) * (2~5:3)',
    ],

    '5x4x2': [

        '5:4:2 [2,0,1] [0,1,2]; 5:4:2 {0,1} {0,0}',
        '5:4:2 [2,0,1] [2,0,1]; 5:4:2 {0,1} {0,1}',
        '5:4:2 [2,0,1] [1,2,0]; 5:4:2 {0,1} {0,2}',
        '5:4:2 [2,0,1] [2,1,0]; 5:4:2 {0,1} {1,0}',
        '5:4:2 [2,0,1] [1,0,2]; 5:4:2 {0,1} {1,1}',
        '5:4:2 [2,0,1] [0,2,1]; 5:4:2 {0,1} {1,2}',
//
//        '# 4:2:5',
//        '# perm references factorial point references',
//        '4:2:5 [0,1,2]; 4:2:5 {0,0}',
//        '4:2:5 [2,0,1]; 4:2:5 {0,1}',
//        '4:2:5 [1,2,0]; 4:2:5 {0,2}',
//        '4:2:5 [1,0,2]; 4:2:5 {1,0}',
//        '4:2:5 [2,1,0]; 4:2:5 {1,1}',
//        '4:2:5 [0,2,1]; 4:2:5 {1,2}',
    ],

    '7x5x3': [
        'a = (3:5~7); b = (7:3~5); c = (5:7~3)',
        'd = (a * a^1)',
        'e = 15:7; f = 21:5; g = 3:35'
    ],

    '2d-boxes': [
        '2:2',
        '3:2',
        '4:2',
        '3:3',
        '5:2',
        '4:3',
        '7:2',
        '5:3',
        '4:4',
        '6:3',
        '5:4',
        '7:3',
        '11:2',
        '6:4',
        '5:5',
        '13:2',
        '9:3',
        '14:2',
        '6:5',
        '8:4',
        '11:3',
        '17:2',
        '7:5',
        '12:3',
        '19:2',
        '10:4',
        '4:10',
        '14:3'
    ],

    ...mgGroups( [     2, 3, 4, 5, 6, 7, 8, 9,10 ] ),
    ...mgGroups( [ 11,12,13,14,15,16,17,18,19,20 ] ),
    ...mgGroups( [ 21,22,23,24,25,26,27,28,29,30 ] ),
    ...mgGroups( [ 31,32,33,34,35,36,37,38,39,40 ] ),
    ...mgGroups( [ 41,42,43,44,45,46,47,48,49,50 ] ),
    ...mgGroups( [ 51,52,53,54,55,56,57,58,59,60 ] ),
    ...mgGroups( [ 61,62,63,64,65,66,67,68,69,70 ] ),
    ...mgGroups( [ 71,72,73,74,75,76,77,78,79,80 ] ),
    ...mgGroups( [ 81,82,83,84,85,86,87,88,89,90 ] ),
    ...mgGroups( [ 91,92,93,94,95,96,97,98,99,100 ] ),

};